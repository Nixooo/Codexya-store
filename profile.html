<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Perfil - Codexya</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <!-- Auth Script -->
    <script src="firebase-auth.js" defer></script>
    <script src="translations.js" defer></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div class="header-left">
                <div class="logo">
                    <a href="index.html">
                        <img src="codexya.png" alt="Codexya Logo">
                    </a>
                </div>
            </div>
            <div class="header-center">
                <div class="search-bar">
                    <svg class="search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 19L13 13M15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1C11.866 1 15 4.13401 15 8Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <input type="text" placeholder="Buscar..." class="search-input" data-i18n="search_placeholder">
                </div>
            </div>
            <div class="header-right">
                <nav class="nav">
                    <ul class="nav-list">
                        <li><a href="index.html" data-i18n="nav_discover">Descubrir</a></li>
                        <li><a href="library.html" data-i18n="nav_library">Mi Biblioteca</a></li>
                        <li><a href="publish.html" data-i18n="nav_publish">Publicar</a></li>
                    </ul>
                </nav>
                <div class="header-actions">
                    <button class="icon-btn" aria-label="Idioma" id="lang-btn">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2"/>
                            <path d="M10 2C12.5 2 14.5 4 15 6M10 18C7.5 18 5.5 16 5 14M15 6H12M15 6L13 8M5 14H8M5 14L7 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </button>
                    <button class="cart-btn" aria-label="Carrito">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M1 1H3L3.4 3M5 11H15L19 5H4.6M5 11L3.4 3M5 11L2.70711 13.2929C2.07714 13.9229 2.52331 15 3.41421 15H15M15 15C13.8954 15 13 15.8954 13 17C13 18.1046 13.8954 19 15 19C16.1046 19 17 18.1046 17 17C17 15.8954 16.1046 15 15 15ZM9 17C9 18.1046 8.10457 19 7 19C5.89543 19 5 18.1046 5 17C5 15.8954 5.89543 15 7 15C8.10457 15 9 15.8954 9 17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span class="cart-count">0</span>
                    </button>
                    <a href="profile.html" class="user-btn active" aria-label="Mi Perfil">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="10" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                            <path d="M3 18C3 14 6.5 12 10 12C13.5 12 17 14 17 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Layout -->
    <div class="main-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-content">
                <h2 class="sidebar-title" data-i18n="section_profile">Mi Perfil</h2>
                
                <div class="sidebar-section">
                    <ul class="sidebar-list">
                        <li>
                            <a href="profile.html" class="sidebar-link active">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z" stroke="currentColor" stroke-width="2"/>
                                </svg>
                                <span data-i18n="profile_details">Detalles de Cuenta</span>
                            </a>
                        </li>
                        <li>
                            <a href="#" class="sidebar-link" id="logout-btn-sidebar">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M10 12.5a.5.5 0 0 1-.5.5h-8a.5.5 0 0 1-.5-.5v-9a.5.5 0 0 1 .5-.5h8a.5.5 0 0 1 .5.5v2a.5.5 0 0 0 1 0v-2A1.5 1.5 0 0 0 9.5 2h-8A1.5 1.5 0 0 0 0 3.5v9A1.5 1.5 0 0 0 1.5 14h8a1.5 1.5 0 0 0 1.5-1.5v-2a.5.5 0 0 0-1 0v2z" fill="currentColor"/>
                                    <path d="M15.854 8.354a.5.5 0 0 0 0-.708l-3-3a.5.5 0 0 0-.708.708L14.293 7.5H5.5a.5.5 0 0 0 0 1h8.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3z" fill="currentColor"/>
                                </svg>
                                <span data-i18n="btn_logout">Cerrar Sesi贸n</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="profile-cover">
                <button class="btn-secondary" style="position: absolute; top: 1rem; right: 1rem; background: rgba(0,0,0,0.5); border: none; color: white; cursor: pointer; padding: 0.5rem 1rem; border-radius: 6px; display: flex; align-items: center; gap: 0.5rem;" data-i18n="profile_cover_edit">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                    Cambiar Portada
                </button>
            </div>
            
            <div class="profile-header-modern">
                <div class="profile-avatar-large">
                    <span id="profile-initials-large">U</span>
                </div>
                <div class="profile-info-modern">
                    <h1 id="profile-name-large">Usuario</h1>
                    <p id="profile-email-large">usuario@ejemplo.com</p>
                    <p class="member-since" style="color: var(--text-muted); font-size: 0.9rem;"><span data-i18n="member_since">Miembro desde</span> 2024</p>
                </div>
                <div class="profile-actions-modern">
                    <button class="btn" style="background: var(--primary-color); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 500;" data-i18n="profile_edit">Editar Perfil</button>
                </div>
            </div>

            <div class="dashboard-grid">
                <!-- Left Column: Stats & Menu -->
                <div class="dashboard-left">
                    <div class="dashboard-card">
                        <h3 data-i18n="profile_details" style="margin-top: 0; margin-bottom: 1rem;">Detalles</h3>
                        <div class="stat-row">
                            <span data-i18n="stats_purchases">Compras</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span data-i18n="stats_reviews">Rese帽as</span>
                            <span class="stat-value">0</span>
                        </div>
                        <div class="stat-row">
                            <span data-i18n="stats_wishlist">Lista de Deseos</span>
                            <span class="stat-value">0</span>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Tabs & Content -->
                <div class="dashboard-right">
                    <div class="dashboard-tabs">
                        <button class="tab-btn active" data-tab="activity" data-i18n="tab_activity">Actividad</button>
                        <button class="tab-btn" data-tab="library" data-i18n="tab_library">Biblioteca</button>
                        <button class="tab-btn" data-tab="settings" data-i18n="tab_settings">Configuraci贸n</button>
                    </div>

                    <div class="tab-content active" id="tab-activity">
                        <div class="activity-feed">
                            <div class="activity-item">
                                <div class="activity-icon"></div>
                                <div class="activity-details">
                                    <h4 data-i18n="activity_joined">Te uniste a Codexya</h4>
                                    <span class="activity-date">2024</span>
                                </div>
                            </div>
                            <!-- More items can be added dynamically -->
                        </div>
                    </div>
                    
                    <div class="tab-content" id="tab-library" style="display:none;">
                         <div style="text-align: center; padding: 3rem; color: var(--text-muted);">
                            <p data-i18n="no_recent_activity">No hay actividad reciente.</p>
                         </div>
                    </div>

                    <div class="tab-content" id="tab-settings" style="display:none;">
                        <div class="dashboard-card">
                             <button id="logout-btn-main" class="btn" style="background-color: #ff4d4f; color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 8px; cursor: pointer; font-weight: 500; display: flex; align-items: center; gap: 0.5rem; width: 100%; justify-content: center;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                                <span data-i18n="btn_logout">Cerrar Sesi贸n</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section footer-brand">
                <div class="footer-logo">
                    <img src="codexya.png" alt="Codexya Logo">
                </div>
                <p data-i18n="footer_desc">Tu marketplace premium para descubrir, comprar y vender el mejor software. nete a miles de creadores y profesionales hoy mismo.</p>
                <div class="social-links" style="margin-top: 1rem;">
                    <a href="#" aria-label="Facebook">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                    </a>
                    <a href="#" aria-label="Twitter">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
                    </a>
                    <a href="#" aria-label="Instagram">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
                    </a>
                    <a href="#" aria-label="GitHub">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
                    </a>
                </div>
            </div>
            
            <div class="footer-section">
                <h4 data-i18n="footer_explore">Explorar</h4>
                <ul>
                    <li><a href="index.html" data-i18n="footer_home">Inicio</a></li>
                    <li><a href="productos.html" data-i18n="footer_products">Productos</a></li>
                    <li><a href="index.html#destacados" data-i18n="footer_featured">Destacados</a></li>
                    <li><a href="new-arrivals.html" data-i18n="footer_new_arrivals">Novedades</a></li>
                    <li><a href="top-sellers.html" data-i18n="footer_best_sellers">M谩s Vendidos</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4 data-i18n="footer_support">Soporte</h4>
                <ul>
                    <li><a href="#" data-i18n="footer_help_center">Centro de Ayuda</a></li>
                    <li><a href="#" data-i18n="footer_faq">Preguntas Frecuentes</a></li>
                    <li><a href="#" data-i18n="footer_status">Estado del Servicio</a></li>
                    <li><a href="#" data-i18n="footer_contact">Contacto</a></li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4 data-i18n="footer_legal">Legal</h4>
                <ul>
                    <li><a href="#" data-i18n="footer_terms_service">T茅rminos de Servicio</a></li>
                    <li><a href="#" data-i18n="footer_privacy_policy">Pol铆tica de Privacidad</a></li>
                    <li><a href="#" data-i18n="footer_refund">Pol铆tica de Reembolso</a></li>
                    <li><a href="#" data-i18n="footer_licenses">Licencias</a></li>
                </ul>
            </div>
        </div>
        
        <div class="footer-bottom">
            <p data-i18n="footer_rights">&copy; 2024 Codexya. Todos los derechos reservados.</p>
            <div class="payment-methods">
                <div class="payment-icon" style="background: white; display: flex; align-items: center; justify-content: center;"><svg width="24" height="16" viewBox="0 0 36 24" xmlns="http://www.w3.org/2000/svg"><path fill="#1A1F71" d="M0 0h36v24H0z"/><path fill="#F79E1B" d="M22 12c0-2.8-1.2-5.3-3.1-7 2-1.4 4.4-2.2 7.1-2.2 6.6 0 12 5.4 12 12s-5.4 12-12 12c-2.7 0-5.1-.8-7.1-2.2 1.9-1.7 3.1-4.2 3.1-7z"/><path fill="#EB001B" d="M14 12c0 2.8 1.2 5.3 3.1 7-2 1.4-4.4 2.2-7.1 2.2C3.4 21.2-2 15.8-2 9.2S3.4-2.8 10-2.8c2.7 0 5.1.8 7.1 2.2-1.9 1.7-3.1 4.2-3.1 7z"/></svg></div>
                <div class="payment-icon" style="background: white; display: flex; align-items: center; justify-content: center;"><svg width="24" height="16" viewBox="0 0 36 24" xmlns="http://www.w3.org/2000/svg"><path fill="#00579F" d="M1.6 0h32.8c.9 0 1.6.7 1.6 1.6v20.8c0 .9-.7 1.6-1.6 1.6H1.6C.7 24 0 23.3 0 22.4V1.6C0 .7.7 0 1.6 0z"/><path fill="#FFF" d="M13.8 13.8h8.4v-3.6h-8.4z"/><path fill="#F79E1B" d="M13.8 17.4h8.4v-2.4h-8.4z"/><path fill="#EB001B" d="M25.2 6.6H10.8v4.8h14.4z"/></svg></div>
                <div class="payment-icon" style="background: white; display: flex; align-items: center; justify-content: center; font-size: 8px; color: black; font-weight: bold;">PAYPAL</div>
            </div>
        </div>
    </footer>
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check auth state
            if (!localStorage.getItem('isLoggedIn')) {
                window.location.href = 'login.html';
                return;
            }

            // Fill user data
            const userName = localStorage.getItem('userName') || 'Usuario';
            const userEmail = localStorage.getItem('userEmail') || 'usuario@ejemplo.com';
            
            const nameEl = document.getElementById('profile-name-large');
            const emailEl = document.getElementById('profile-email-large');
            const initialsEl = document.getElementById('profile-initials-large');
            
            if (nameEl) nameEl.textContent = userName;
            if (emailEl) emailEl.textContent = userEmail;
            if (initialsEl) initialsEl.textContent = userName.charAt(0).toUpperCase();

            // Tab Switching Logic
            const tabBtns = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => {
                        c.classList.remove('active');
                        c.style.display = 'none';
                    });

                    // Add active class to clicked button and target content
                    btn.classList.add('active');
                    const targetContent = document.getElementById(`tab-${tabId}`);
                    if (targetContent) {
                        targetContent.classList.add('active');
                        targetContent.style.display = 'block';
                    }
                });
            });

            // Logout functionality
            function handleLogout(e) {
                e.preventDefault();
                // Ensure getTranslation is available
                const msg = (typeof getTranslation === 'function') ? 
                            getTranslation('confirm_logout', { name: userName }) : 
                            `驴Est谩s seguro de que deseas cerrar sesi贸n, ${userName}?`;
                            
                const confirmLogout = confirm(msg);
                if (confirmLogout) {
                    // Try firebase signOut if available
                    if (window.firebase && firebase.auth()) {
                        firebase.auth().signOut().then(() => {
                            performLogout();
                        }).catch((error) => {
                            console.error('Error signing out:', error);
                            // Force logout anyway on local storage
                            performLogout();
                        });
                    } else {
                        performLogout();
                    }
                }
            }

            function performLogout() {
                localStorage.removeItem('isLoggedIn');
                localStorage.removeItem('userName');
                localStorage.removeItem('userEmail');
                
                const msg = (typeof getTranslation === 'function') ? 
                            getTranslation('alert_logout_success') : 
                            'Has cerrado sesi贸n exitosamente.';
                alert(msg);
                window.location.href = 'index.html';
            }

            const logoutBtnSidebar = document.getElementById('logout-btn-sidebar');
            const logoutBtnMain = document.getElementById('logout-btn-main');

            if (logoutBtnSidebar) logoutBtnSidebar.addEventListener('click', handleLogout);
            if (logoutBtnMain) logoutBtnMain.addEventListener('click', handleLogout);
        });
    </script>
</body>
</html>
