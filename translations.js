const translations = {
    es: {
        "search_placeholder": "Buscar software, programas...",
        "nav_discover": "Descubrir",
        "nav_library": "Mi Biblioteca",
        "nav_publish": "Publicar",
        "sidebar_discover": "Descubrir",
        "sidebar_offers": "Ofertas",
        "sidebar_free_limited": "Gratis por Tiempo Limitado",
        "sidebar_on_sale": "En Oferta",
        "sidebar_categories": "Categorías",
        "cat_productivity": "Productividad",
        "cat_design": "Diseño",
        "cat_security": "Seguridad",
        "cat_analysis": "Análisis",
        "cat_development": "Desarrollo",
        "cat_multimedia": "Multimedia",
        "sidebar_types": "Tipos de Producto",
        "type_software": "Software",
        "type_apps": "Aplicaciones",
        "type_tools": "Herramientas",
        "type_plugins": "Plugins",
        "type_utilities": "Utilidades",
        "type_extensions": "Extensiones",
        "type_templates": "Templates",
        "type_sdks": "SDKs",
        "sidebar_platforms": "Plataformas",
        "sidebar_price": "Precio",
        "price_free": "Gratis",
        "price_under_10": "Menos de $10",
        "price_10_50": "$10 - $50",
        "price_50_100": "$50 - $100",
        "price_over_100": "Más de $100",
        "hero_badge": "DESCUBRIR",
        "hero_title": "En Oferta",
        "hero_desc": "Encuentra las mejores ofertas en software premium por tiempo limitado.",
        "hero_btn": "Comprar Ahora",
        "slider_featured_content": "CONTENIDO DESTACADO",
        "slider_featured_seller": "VENDEDOR DESTACADO",
        "filter_all": "Todos",
        "section_popular": "Populares ahora",
        "section_new": "Nuevos lanzamientos",
        "btn_add_cart": "Añadir al Carrito",
        "btn_added": "✓ Añadido",
        "auth_login": "Iniciar Sesión",
        "auth_register": "Registrarse",
        "auth_email": "Correo Electrónico",
        "auth_password": "Contraseña",
        "auth_name": "Nombre",
        "auth_lastname": "Apellido",
        "auth_create_account": "Crear Cuenta",
        "auth_welcome_back": "Bienvenido de nuevo",
        "auth_enter_credentials": "Ingresa tus credenciales para acceder a tu cuenta.",
        "auth_join_revolution": "Únete a la revolución creativa.",
        "auth_join_desc": "Crea tu cuenta hoy y accede a miles de recursos exclusivos.",
        "auth_already_account": "¿Ya tienes una cuenta?",
        "auth_no_account": "¿No tienes una cuenta?",
        "auth_forgot_password": "¿Olvidaste tu contraseña?",
        "auth_continue_google": "O continúa con",
        "auth_register_google": "O regístrate con",
        "footer_rights": "© 2024 Codexya",
        "footer_privacy": "Privacidad",
        "footer_terms": "Términos",
        "btn_publish_now": "Publicar Ahora",
        "status_update_available": "Actualización disp.",
        "footer_desc": "Tu marketplace premium para descubrir, comprar y vender el mejor software. Únete a miles de creadores y profesionales hoy mismo.",
        "footer_explore": "Explorar",
        "footer_home": "Inicio",
        "footer_products": "Productos",
        "footer_featured": "Destacados",
        "footer_new_arrivals": "Novedades",
        "footer_best_sellers": "Más Vendidos",
        "footer_support": "Soporte",
        "footer_help_center": "Centro de Ayuda",
        "footer_faq": "Preguntas Frecuentes",
        "footer_status": "Estado del Servicio",
        "footer_contact": "Contacto",
        "footer_legal": "Legal",
        "footer_terms_service": "Términos de Servicio",
        "footer_privacy_policy": "Política de Privacidad",
        "footer_refund": "Política de Reembolso",
        "footer_licenses": "Licencias",
        "alert_cart_items": "Tienes {count} artículos en tu carrito. Ir al checkout...",
        "alert_quick_view": "Función de vista rápida - Próximamente",
        "btn_quick_view_text": "Vista Rápida",
        "section_developers_title": "Mejores Desarrolladores",
        "section_testimonials_title": "Lo que dicen nuestros usuarios",
        "section_faq_title": "Preguntas Frecuentes",
        "newsletter_title": "Mantente Actualizado",
        "newsletter_desc": "Suscríbete para recibir las últimas ofertas, lanzamientos y novedades de software directamente en tu bandeja de entrada.",
        "newsletter_placeholder": "Tu correo electrónico",
        "newsletter_btn": "Suscribirse",
        "trust_secure": "Compra Segura",
        "trust_secure_desc": "Pagos 100% protegidos",
        "trust_instant": "Descarga Instantánea",
        "trust_instant_desc": "Acceso inmediato al archivo",
        "trust_support": "Soporte 24/7",
        "trust_support_desc": "Ayuda cuando la necesites",
        "trust_guarantee": "Garantía de Calidad",
        "trust_guarantee_desc": "Software verificado",
        "dev_view_all": "Ver todos",
        "test_quote_1": "\"La mejor plataforma para encontrar software de calidad. El proceso de compra es súper rápido y seguro.\"",
        "test_role_1": "Diseñadora Gráfica",
        "test_quote_2": "\"He vendido mis plugins aquí por meses y la comunidad es increíble. Muy recomendado para desarrolladores.\"",
        "test_role_2": "Desarrollador Web",
        "test_quote_3": "\"Atención al cliente de primera. Tuve una duda con una licencia y me la resolvieron en minutos.\"",
        "test_role_3": "Project Manager",
        "faq_q_1": "¿Cómo recibo mi software?",
        "faq_a_1": "Una vez completado el pago, recibirás un correo electrónico con el enlace de descarga y tu clave de licencia inmediatamente. También estará disponible en tu biblioteca.",
        "faq_q_2": "¿Ofrecen garantía de reembolso?",
        "faq_a_2": "Sí, ofrecemos una garantía de reembolso de 30 días si el software no funciona como se describe o tiene problemas técnicos que no podemos resolver.",
        "faq_q_3": "¿Es seguro comprar aquí?",
        "faq_a_3": "Absolutamente. Utilizamos encriptación SSL de grado bancario para todas las transacciones y no almacenamos tus datos de pago.",
        "section_profile": "Mi Perfil",
        "profile_details": "Detalles de Cuenta",
        "btn_logout": "Cerrar Sesión"
    },
    en: {
        "search_placeholder": "Search software, programs...", 
        "nav_discover": "Discover",
        "nav_library": "My Library",
        "nav_publish": "Publish",
        "sidebar_discover": "Discover",
        "sidebar_offers": "Offers",
        "sidebar_free_limited": "Free for Limited Time",
        "sidebar_on_sale": "On Sale",
        "sidebar_categories": "Categories",
        "cat_productivity": "Productivity",
        "cat_design": "Design",
        "cat_security": "Security",
        "cat_analysis": "Analysis",
        "cat_development": "Development",
        "cat_multimedia": "Multimedia",
        "cat_utilities": "Utilities",
        "cat_systems": "Systems",
        "sidebar_types": "Product Types",
        "type_software": "Software",
        "type_apps": "Apps",
        "type_tools": "Tools",
        "type_plugins": "Plugins",
        "type_utilities": "Utilities",
        "type_extensions": "Extensions",
        "type_templates": "Templates",
        "type_sdks": "SDKs",
        "sidebar_platforms": "Platforms",
        "sidebar_price": "Price",
        "price_free": "Free",
        "price_under_10": "Under $10",
        "price_10_50": "$10 - $50",
        "price_50_100": "$50 - $100",
        "price_over_100": "Over $100",
        "hero_badge": "DISCOVER",
        "hero_title": "On Sale",
        "hero_desc": "Find the best deals on premium software for a limited time.",
        "hero_btn": "Shop Now",
        "slider_featured_content": "FEATURED CONTENT",
        "slider_featured_seller": "FEATURED SELLER",
        "filter_all": "All",
        "section_popular": "Popular Now",
        "section_new": "New Releases",
        "btn_add_cart": "Add to Cart",
        "btn_added": "✓ Added",
        "auth_login": "Log In",
        "auth_register": "Sign Up",
        "auth_email": "Email Address",
        "auth_password": "Password",
        "auth_name": "Name",
        "auth_lastname": "Last Name",
        "auth_create_account": "Create Account",
        "auth_welcome_back": "Welcome Back",
        "auth_enter_credentials": "Enter your credentials to access your account.",
        "auth_join_revolution": "Join the creative revolution.",
        "auth_join_desc": "Create your account today and access thousands of exclusive resources.",
        "auth_already_account": "Already have an account?",
        "auth_no_account": "Don't have an account?",
        "auth_forgot_password": "Forgot your password?",
        "auth_continue_google": "Or continue with",
        "auth_register_google": "Or sign up with",
        "footer_rights": "© 2024 Codexya",
        "footer_privacy": "Privacy",
        "footer_terms": "Terms",
        "form_price": "Price ($)",
        "form_category": "Category",
        "form_images": "Images",
        "placeholder_product_name": "Ex: Super Video Editor",
        "placeholder_short_desc": "Brief description for listings",
        "placeholder_detailed_desc": "Describe all features...",
        "form_drag_drop": "Drag images here or click to upload",
        "placeholder_email": "name@example.com",
        "auth_remember_me": "Remember me",
        "auth_subtitle_register": "Start your Codexya journey for free.",
        "placeholder_name_example": "John",
        "placeholder_lastname_example": "Doe",
        "auth_terms_html": "By creating an account, you agree to our <a href='#'>Terms of Service</a> and <a href='#'>Privacy Policy</a>.",
        "alert_cart_items": "You have {count} items in your cart. Go to checkout...",
        "alert_quick_view": "Quick view function - Coming soon",
        "btn_quick_view_text": "Quick View",
        "section_developers_title": "Top Developers",
        "section_testimonials_title": "What Our Users Say",
        "section_faq_title": "Frequently Asked Questions",
        "newsletter_title": "Stay Updated",
        "newsletter_desc": "Subscribe to receive the latest offers, releases, and software news directly in your inbox.",
        "newsletter_placeholder": "Your email address",
        "newsletter_btn": "Subscribe",
        "trust_secure": "Secure Payment",
        "trust_secure_desc": "100% protected payments",
        "trust_instant": "Instant Download",
        "trust_instant_desc": "Immediate access to file",
        "trust_support": "24/7 Support",
        "trust_support_desc": "Help when you need it",
        "trust_guarantee": "Quality Guarantee",
        "trust_guarantee_desc": "Verified software",
        "dev_view_all": "View all",
        "test_quote_1": "\"The best platform to find quality software. The checkout process is super fast and secure.\"",
        "test_role_1": "Graphic Designer",
        "test_quote_2": "\"I've been selling my plugins here for months and the community is amazing. Highly recommended for developers.\"",
        "test_role_2": "Web Developer",
        "test_quote_3": "\"Top-notch customer support. I had a question about a license and they solved it in minutes.\"",
        "test_role_3": "Project Manager",
        "faq_q_1": "How do I receive my software?",
        "faq_a_1": "Once payment is completed, you will receive an email with the download link and your license key immediately. It will also be available in your library.",
        "faq_q_2": "Do you offer a refund guarantee?",
        "faq_a_2": "Yes, we offer a 30-day money-back guarantee if the software does not work as described or has technical issues we cannot resolve.",
        "faq_q_3": "Is it safe to buy here?",
        "faq_a_3": "Absolutely. We use bank-grade SSL encryption for all transactions and do not store your payment details.",
        "section_profile": "My Profile",
        "profile_details": "Account Details",
        "btn_logout": "Log Out"
    },
    fr: {
        "search_placeholder": "Rechercher des logiciels...",
        "nav_discover": "Découvrir",
        "nav_library": "Ma Bibliothèque",
        "nav_publish": "Publier",
        "sidebar_discover": "Découvrir",
        "sidebar_offers": "Offres",
        "sidebar_free_limited": "Gratuit pour une durée limitée",
        "sidebar_on_sale": "En Promo",
        "sidebar_categories": "Catégories",
        "cat_productivity": "Productivité",
        "cat_design": "Design",
        "cat_security": "Sécurité",
        "cat_analysis": "Analyse",
        "cat_development": "Développement",
        "cat_multimedia": "Multimédia",
        "sidebar_types": "Types de Produits",
        "type_software": "Logiciels",
        "type_apps": "Applications",
        "type_tools": "Outils",
        "type_plugins": "Plugins",
        "type_utilities": "Utilitaires",
        "type_extensions": "Extensions",
        "type_templates": "Modèles",
        "type_sdks": "SDKs",
        "sidebar_platforms": "Plateformes",
        "sidebar_price": "Prix",
        "price_free": "Gratuit",
        "price_under_10": "Moins de 10 $",
        "price_10_50": "10 $ - 50 $",
        "price_50_100": "50 $ - 100 $",
        "price_over_100": "Plus de 100 $",
        "hero_badge": "DÉCOUVRIR",
        "hero_title": "En Promo",
        "hero_desc": "Trouvez les meilleures offres sur les logiciels premium pour une durée limitée.",
        "hero_btn": "Acheter",
        "slider_featured_content": "CONTENU EN VEDETTE",
        "slider_featured_seller": "VENDEUR EN VEDETTE",
        "filter_all": "Tous",
        "section_popular": "Populaire maintenant",
        "section_new": "Nouvelles sorties",
        "section_featured_products": "Produits en Vedette",
        "section_new_arrivals_title": "Nouvelles Arrivées",
        "btn_view_all": "Voir Tout",
        "btn_quick_view_text": "Aperçu Rapide",
        "btn_add_cart": "Ajouter au panier",
        "btn_added": "✓ Ajouté",
        "auth_login": "Connexion",
        "auth_register": "S'inscrire",
        "auth_email": "Adresse e-mail",
        "auth_password": "Mot de passe",
        "auth_name": "Prénom",
        "auth_lastname": "Nom",
        "auth_create_account": "Créer un compte",
        "auth_welcome_back": "Bon retour",
        "auth_enter_credentials": "Entrez vos identifiants pour accéder à votre compte.",
        "auth_join_revolution": "Rejoignez la révolution créative.",
        "auth_join_desc": "Créez votre compte aujourd'hui et accédez à des milliers de ressources exclusives.",
        "auth_already_account": "Vous avez déjà un compte ?",
        "auth_no_account": "Vous n'avez pas de compte ?",
        "auth_forgot_password": "Mot de passe oublié ?",
        "auth_continue_google": "Ou continuer avec",
        "auth_register_google": "Ou s'inscrire avec",
        "footer_rights": "© 2024 Codexya",
        "footer_privacy": "Confidentialité",
        "footer_terms": "Conditions",
        "section_all_products": "Tous les Produits",
        "filter_sort": "Trier par :",
        "sort_featured": "En vedette",
        "sort_price_low": "Prix : Croissant",
        "sort_price_high": "Prix : Décroissant",
        "sort_name": "Nom A-Z",
        "filter_category_label": "Catégorie :",
        "section_my_library": "Ma Bibliothèque",
        "search_library_placeholder": "Rechercher dans ma bibliothèque...",
        "sidebar_collection": "Collection",
        "sidebar_all_software": "Tout les Logiciels",
        "sidebar_favorites": "Favoris",
        "sidebar_recent_downloads": "Téléchargements Récents",
        "sidebar_status": "Statut",
        "status_installed": "Installé",
        "status_not_installed": "Non Installé",
        "status_updates": "Mises à jour",
        "filter_recent": "Récents",
        "filter_alphabetical": "Alphabétique",
        "filter_last_use": "Dernière utilisation",
        "status_acquired": "Acquis le :",
        "btn_open": "Ouvrir",
        "btn_update": "Mettre à jour",
        "btn_install": "Installer",
        "section_publish_new": "Publier un Nouveau Logiciel",
        "sidebar_creator_studio": "Studio Créateur",
        "sidebar_new_product": "Nouveau Produit",
        "sidebar_my_products": "Mes Produits",
        "sidebar_sales": "Ventes",
        "form_product_name": "Nom du Produit",
        "form_short_desc": "Description Courte",
        "form_detailed_desc": "Description Détaillée",
        "form_price": "Prix ($)",
        "form_images": "Images",
        "form_drag_drop": "Glissez des images ici ou cliquez pour télécharger",
        "btn_save_draft": "Enregistrer le Brouillon",
        "btn_publish_now": "Publier Maintenant",
        "login_brand_title": "Découvrez le logiciel du futur.",
        "login_brand_desc": "Rejoignez la plus grande communauté de développeurs et de créatifs. Achetez, vendez et découvrez des outils incroyables pour booster votre travail.",
        "placeholder_email": "nom@exemple.com",
        "auth_remember_me": "Se souvenir de moi",
        "auth_terms_html": "En créant un compte, vous acceptez nos <a href='#'>Conditions d'utilisation</a> et notre <a href='#'>Politique de confidentialité</a>.",
        "alert_user_not_found": "Aucun compte trouvé avec cet e-mail.",
        "alert_wrong_password": "Mot de passe incorrect.",
        "alert_email_in_use": "Cet e-mail est déjà enregistré.",
        "alert_weak_password": "Le mot de passe doit contenir au moins 6 caractères.",
        "alert_invalid_email": "Adresse e-mail invalide.",
        "alert_welcome": "Bienvenue, {name} ! Votre compte a été créé.",
        "alert_enter_email": "Veuillez entrer votre adresse e-mail dans le champ et cliquer à nouveau sur 'Mot de passe oublié ?'.",
        "alert_reset_sent": "Un e-mail de récupération a été envoyé à {email}. Vérifiez votre boîte de réception.",
        "alert_logout_success": "Vous vous êtes déconnecté avec succès.",
        "confirm_logout": "Bonjour {name}. Voulez-vous vous déconnecter ?",
        "alert_cart_empty": "Votre panier est vide.",
        "alert_cart_items": "Vous avez {count} articles dans votre panier. Passer à la caisse...",
        "alert_quick_view": "Fonction d'aperçu rapide - Bientôt disponible",
        "section_developers_title": "Meilleurs Développeurs",
        "section_testimonials_title": "Ce que disent nos utilisateurs",
        "section_faq_title": "Foire Aux Questions",
        "newsletter_title": "Restez à jour",
        "newsletter_desc": "Abonnez-vous pour recevoir les dernières offres, sorties et nouvelles logicielles directement dans votre boîte de réception.",
        "newsletter_placeholder": "Votre adresse e-mail",
        "newsletter_btn": "S'abonner",
        "dev_view_all": "Voir tous",
        "test_quote_1": "\"La meilleure plateforme pour trouver des logiciels de qualité. Le processus d'achat est super rapide et sécurisé.\"",
        "test_role_1": "Graphiste",
        "test_quote_2": "\"Je vends mes plugins ici depuis des mois et la communauté est incroyable. Hautement recommandé pour les développeurs.\"",
        "test_role_2": "Développeur Web",
        "test_quote_3": "\"Support client de premier ordre. J'avais une question sur une licence et ils l'ont résolue en quelques minutes.\"",
        "test_role_3": "Chef de Projet",
        "faq_q_1": "Comment reçois-je mon logiciel ?",
        "faq_a_1": "Une fois le paiement effectué, vous recevrez immédiatement un e-mail avec le lien de téléchargement et votre clé de licence. Il sera également disponible dans votre bibliothèque.",
        "faq_q_2": "Offrez-vous une garantie de remboursement ?",
        "faq_a_2": "Oui, nous offrons une garantie de remboursement de 30 jours si le logiciel ne fonctionne pas comme décrit ou présente des problèmes techniques que nous ne pouvons pas résoudre.",
        "faq_q_3": "Est-il sûr d'acheter ici ?",
        "faq_a_3": "Absolument. Nous utilisons un cryptage SSL de niveau bancaire pour toutes les transactions et ne stockons pas vos données de paiement.",
        "section_profile": "Mon Profil",
        "profile_details": "Détails du Compte",
        "btn_logout": "Se Déconnecter",
        "profile_cover_edit": "Changer de Couverture",
        "profile_edit": "Modifier le Profil",
        "stats_purchases": "Achats",
        "stats_reviews": "Avis",
        "stats_wishlist": "Liste de Souhaits",
        "tab_activity": "Activité",
        "tab_library": "Bibliothèque",
        "tab_settings": "Paramètres",
        "activity_joined": "Rejoint Codexya",
        "activity_purchased": "Acheté",
        "no_recent_activity": "Aucune activité récente.",
        "member_since": "Membre depuis"
    }
};

// Obtener traducción con parámetros
function getTranslation(key, params = {}) {
    const lang = localStorage.getItem('preferredLanguage') || 'es';
    let text = (translations[lang] && translations[lang][key]) || key;
    
    // Reemplazar parámetros {param}
    Object.keys(params).forEach(param => {
        text = text.replace(new RegExp(`{${param}}`, 'g'), params[param]);
    });
    
    return text;
}

// Función para cambiar idioma
function setLanguage(lang) {
    if (!translations[lang]) return;

    // Guardar preferencia
    localStorage.setItem('preferredLanguage', lang);
    document.documentElement.lang = lang;

    // Actualizar textos con data-i18n
    const elements = document.querySelectorAll('[data-i18n]');
    elements.forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (translations[lang][key]) {
            // Si es un input, actualizar placeholder
            if (el.tagName === 'INPUT' && el.getAttribute('placeholder')) {
                el.placeholder = translations[lang][key];
            } else {
                // Preservar iconos SVG si están dentro del elemento
                const icon = el.querySelector('svg');
                if (icon) {
                    // Si hay icono, asumimos que el texto es el último nodo o está en un span
                    // Esto es complejo, mejor estructurar el HTML para que el texto esté en un span separado
                    // o reemplazar solo el texto
                    const textNode = Array.from(el.childNodes).find(node => node.nodeType === Node.TEXT_NODE && node.textContent.trim() !== '');
                    if (textNode) {
                        textNode.textContent = ' ' + translations[lang][key];
                    } else {
                        // Buscar span interno con texto
                         const span = el.querySelector('span:not(.cart-count):not(.sidebar-count)');
                         if (span) {
                             span.textContent = translations[lang][key];
                         }
                    }
                } else {
                    el.textContent = translations[lang][key];
                }
            }
        }
    });

    // Actualizar botones de añadir al carrito (casos especiales dinámicos)
    const addCartBtns = document.querySelectorAll('.btn-add-cart');
    addCartBtns.forEach(btn => {
        if (!btn.textContent.includes('✓')) {
            btn.textContent = translations[lang]['btn_add_cart'];
        }
    });
}

// Inicializar idioma
document.addEventListener('DOMContentLoaded', () => {
    const savedLang = localStorage.getItem('preferredLanguage') || 'es';
    setLanguage(savedLang);
});
